{
 "signatures": [
  {
   "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
   "sig": "5e4918b5196a3a86d3bfdc187550a615697e74684b49cc7c26e950409df39108e5fb88558e7e4fd40a50e8d32313dd703f42d10e3e4104e73cbbc166f244934be76774ab21e812022a96872e1ad6fcda9270e25a87160af3f0d786d5f2b29fb9fe7e95b6d36f12029e701dbb312e13378f86febdd6a8289acee0bce29b8bdd035cd95fd2df8c959c1fd8577ca897b6ba8160114675e347694a54f90126ea9752566277400d248adb3881fd78b13f8473fd1ab3fceb6c7994ecda4448f43d8b972a5b8dcde1188269c9b36363465d87c4276c72b433dc5c868ef41ab2b2ed3e8373e11cce5333207bcb852a887e2050a0d08a58e66e2711af36d5ae5438d284524666bd77daaa523c9152f3a7f5c9161da06bd4c89f423ebc5a0ef1113672760f9cf8562de4b3496a8060d0d447ffa61c6f199d6070fa87b30f68dee71249c2fd050235762631080378f6ef298efdf1678f397409a5ade4820ed372e4608fdaedf316aa4c9bf1e9cf76e82d3e528866a4242bcb67a4f8a100d3741cacaf1be3ef"
  }
 ],
 "signed": {
  "_type": "layout",
  "expires": "2026-06-24T02:03:01Z",
  "inspect": [
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [],
    "name": "verify-json",
    "run": [
     "terraform",
     "show",
     "-json",
     "tfplan.binary"
    ]
   },
   {
    "_type": "inspection",
    "expected_materials": [],
    "expected_products": [],
    "name": "sigstore-verify-inspection",
    "run": [
     "cat",
     "sigstore_verify.txt"
    ]
   }
  ],
  "keys": {
   "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1": {
    "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
    "keytype": "rsa",
    "keyval": {
     "public": "-----BEGIN PUBLIC KEY-----\nMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAuOlhGQULSD2cV2rwUuHM\n1CSyP7CfoLJ5OjNJIlfuLL2Mw9dEaxUFAMbVUjW8G02Xv8COI+yRc1/pUYgpeyAJ\n/8iEI9so1bUL82OwxnCspd/75R2udSJSdQLPKn4AHYhy2i8zsGE0GnL35+KtaLRR\nL7mPe5oBdcxpkpuP/G/W8Yt50gmon89/6WIGBdOznGdlnK7i7UNiMR0TwyDVJpcF\nZyNTSAaPhK0rp6yueMSBqKig8zXFhnHsBC8PHBkQ8YaaR1KtUUmu0+Hh5qZUuwTa\nRy36APKdbsfgp91+jvBvkkhCxaN6/QCGraH/ZzJ+cK6QRKjhhsFarNs85TheMDox\nAt5S9LGF2Vik6YkocaB9AHfJgKgxg4GysPuXexFvEDbedQtpjmAxaVfg+AAfC2f2\nsa0c+Mi/1jLIyPHymk9kWlAcmM7ji4R+WAkK5gGVm2l7Kt1EHug4Y08zOOHcmPzW\nuevnLKYGBiLE7NeEyH50lEXAka1EylwA6lyIzZpzfAaPAgMBAAE=\n-----END PUBLIC KEY-----\n"
    },
    "scheme": "rsassa-pss-sha256"
   }
  },
  "readme": "",
  "steps": [
   {
    "_type": "step",
    "expected_command": [
     "bash",
     "-lc",
     "timeout 600 terraform init -input=false -no-color"
    ],
    "expected_materials": [],
    "expected_products": [
     [
      "CREATE",
      ".terraform/*"
     ],
     [
      "CREATE",
      "terraform.lock.hcl"
     ]
    ],
    "name": "terraform-init",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "terraform plan -out=tfplan.binary -input=false"
    ],
    "expected_materials": [
     [
      "MATCH",
      "*",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-init"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "terraform-plan",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "sigstore sign terra/tfplan.binary "
    ],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary.sigstore.json"
     ]
    ],
    "name": "sigstore-sign",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "MATCH",
      "tfplan.binary.sigstore.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-sign"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "sigstore_verify.txt"
     ]
    ],
    "name": "sigstore-verify",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "terraformplan.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "create-terraformplan-json",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "terraformplan.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "create-terraformplan-json"
     ],
     [
      "ALLOW",
      "tf.rego"
     ],
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "opa_result.txt"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "opa-policy",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   }
  ]
 }
}