{
 "signatures": [
  {
   "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
   "sig": "08ad3a2a2e2d347059c1ec3a3265d0897c76a67650d47e07a6eb23f48b078407093c0f367bfb0f695eca6cb80506afb0ecc7f8451913ec4be906b28b33ceab9cd946f3c377518298ab902a35f13c9c200b9f08d2339d114a7c0c1bf67afe7646cacfe50ce3022953385d5044181bce31a77149b929613b4964d029a3338dff154e99eb35770492344d520d77c3b898962fb70b8a6a6a23e670e9a46663eb0222a0df876494ecfbea4539130e2a219e505caf850f8bb52262c9fceb45027ac67b98d1e0a56b3b40a9cf35dc6571da033342498f3cd82cde43b38cff5a51bdfa86eb3ca3281d38c58c1fc4b6663306099f6bca1e0a0b9f40b5244f6c8ae5b7c551a23daf7c14e054248845fd3d1a6bed0e93a49b6dfa8f96becbfeadfcc11a41cc97cf6bb1377513141202b61e7cc505c5649ef588c7ff8f6cfac45a1e9ef3753530151b9e9888afc5119c7caa322bc27d7ec1877f5da134ad99623c64c0551e575c437ec28249e28cbc856084c1bc908ed7ea9146b25cba37a31579b690f6f97a"
  }
 ],
 "signed": {
  "_type": "layout",
  "expires": "2026-06-24T02:19:41Z",
  "inspect": [
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [],
    "name": "verify-json",
    "run": [
     "terraform",
     "show",
     "-json",
     "tfplan.binary"
    ]
   },
   {
    "_type": "inspection",
    "expected_materials": [],
    "expected_products": [],
    "name": "sigstore-verify-inspection",
    "run": [
     "cat",
     "sigstore_verify.txt"
    ]
   }
  ],
  "keys": {
   "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1": {
    "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
    "keytype": "rsa",
    "keyval": {
     "public": "-----BEGIN PUBLIC KEY-----\nMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAuOlhGQULSD2cV2rwUuHM\n1CSyP7CfoLJ5OjNJIlfuLL2Mw9dEaxUFAMbVUjW8G02Xv8COI+yRc1/pUYgpeyAJ\n/8iEI9so1bUL82OwxnCspd/75R2udSJSdQLPKn4AHYhy2i8zsGE0GnL35+KtaLRR\nL7mPe5oBdcxpkpuP/G/W8Yt50gmon89/6WIGBdOznGdlnK7i7UNiMR0TwyDVJpcF\nZyNTSAaPhK0rp6yueMSBqKig8zXFhnHsBC8PHBkQ8YaaR1KtUUmu0+Hh5qZUuwTa\nRy36APKdbsfgp91+jvBvkkhCxaN6/QCGraH/ZzJ+cK6QRKjhhsFarNs85TheMDox\nAt5S9LGF2Vik6YkocaB9AHfJgKgxg4GysPuXexFvEDbedQtpjmAxaVfg+AAfC2f2\nsa0c+Mi/1jLIyPHymk9kWlAcmM7ji4R+WAkK5gGVm2l7Kt1EHug4Y08zOOHcmPzW\nuevnLKYGBiLE7NeEyH50lEXAka1EylwA6lyIzZpzfAaPAgMBAAE=\n-----END PUBLIC KEY-----\n"
    },
    "scheme": "rsassa-pss-sha256"
   }
  },
  "readme": "",
  "steps": [
   {
    "_type": "step",
    "expected_command": [
     "bash",
     "-lc",
     "timeout 600 terraform init -input=false -no-color"
    ],
    "expected_materials": [],
    "expected_products": [
     [
      "CREATE",
      ".terraform/*"
     ],
     [
      "CREATE",
      "terraform.lock.hcl"
     ]
    ],
    "name": "terraform-init",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "terraform plan -out=tfplan.binary -input=false"
    ],
    "expected_materials": [
     [
      "MATCH",
      "*",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-init"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "terraform-plan",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "sigstore sign terra/tfplan.binary "
    ],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary.sigstore.json"
     ]
    ],
    "name": "sigstore-sign",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary.sigstore.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-sign"
     ],
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "sigstore_verify.txt"
     ]
    ],
    "name": "sigstore-verify",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "terraformplan.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "create-terraformplan-json",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "terraformplan.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "create-terraformplan-json"
     ],
     [
      "ALLOW",
      "tf.rego"
     ],
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "opa_result.txt"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "opa-policy",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   }
  ]
 }
}