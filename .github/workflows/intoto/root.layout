{
 "signatures": [
  {
   "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
   "sig": "6d3380ac0f90e55f4c2c7c388458cf9baa270bf9daf03cd3c136dfa6a6895b6789d66017c9372f36f2336ed703b20f008c6667505144c1a39acc2f07eb67eaee3a2cd3c0f79fc3fc586843a7bab0b8f7a09d1f8aa8bf7d984fa8752715ae2bafa944e3442cc11003a22f7d8ea644f34f242ed407e93f9abfc81f7404f4475f3a0c625bddd2a1a182563a90ed7cba157cc843cb3cad22308adc6ebcf1fddbce2dd36178bf1b142158d1026dcd6c0c5a5be6f673a32bd903afdf8f6d0941021eeb065afd83cd0aa5da507d1acc57277de5924b5b9f7a863e35ab4fb4f2a609b87fd8a613e4cb124c16249220f1e0c5bab672d87cb3d001838aa44d5b0866411193612ec1b4691ae727d215f9736ad6425c094ca1f2f28e3925a5c6013bb602f6b55b24662dec43890d13579d6add43d647aa6fc17170d99d37372447bff3762482958871c985757031b523ddc3168ca12a5e9f01d17b53ea57c3ee8087059c6a70f8fa353e63c6e428f70c0c94c4d3d8eeb6bba649eb832fd82af54ff7f5867444"
  }
 ],
 "signed": {
  "_type": "layout",
  "expires": "2026-06-24T02:52:40Z",
  "inspect": [
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "sigstore_verify.txt",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-verify"
     ]
    ],
    "expected_products": [],
    "name": "sigstore-verify-inspection",
    "run": [
     "grep",
     "-q",
     "Verified",
     "sigstore_verify.txt"
    ]
   }
  ],
  "keys": {
   "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1": {
    "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
    "keytype": "rsa",
    "keyval": {
     "public": "-----BEGIN PUBLIC KEY-----\nMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAuOlhGQULSD2cV2rwUuHM\n1CSyP7CfoLJ5OjNJIlfuLL2Mw9dEaxUFAMbVUjW8G02Xv8COI+yRc1/pUYgpeyAJ\n/8iEI9so1bUL82OwxnCspd/75R2udSJSdQLPKn4AHYhy2i8zsGE0GnL35+KtaLRR\nL7mPe5oBdcxpkpuP/G/W8Yt50gmon89/6WIGBdOznGdlnK7i7UNiMR0TwyDVJpcF\nZyNTSAaPhK0rp6yueMSBqKig8zXFhnHsBC8PHBkQ8YaaR1KtUUmu0+Hh5qZUuwTa\nRy36APKdbsfgp91+jvBvkkhCxaN6/QCGraH/ZzJ+cK6QRKjhhsFarNs85TheMDox\nAt5S9LGF2Vik6YkocaB9AHfJgKgxg4GysPuXexFvEDbedQtpjmAxaVfg+AAfC2f2\nsa0c+Mi/1jLIyPHymk9kWlAcmM7ji4R+WAkK5gGVm2l7Kt1EHug4Y08zOOHcmPzW\nuevnLKYGBiLE7NeEyH50lEXAka1EylwA6lyIzZpzfAaPAgMBAAE=\n-----END PUBLIC KEY-----\n"
    },
    "scheme": "rsassa-pss-sha256"
   }
  },
  "readme": "",
  "steps": [
   {
    "_type": "step",
    "expected_command": [
     "bash",
     "-lc",
     "timeout 600 terraform init -input=false -no-color"
    ],
    "expected_materials": [],
    "expected_products": [
     [
      "CREATE",
      ".terraform/*"
     ],
     [
      "CREATE",
      "terraform.lock.hcl"
     ]
    ],
    "name": "terraform-init",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "terraform plan -out=tfplan.binary -input=false"
    ],
    "expected_materials": [
     [
      "MATCH",
      "*",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-init"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "terraform-plan",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "sigstore sign terra/tfplan.binary "
    ],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary.sigstore.json"
     ]
    ],
    "name": "sigstore-sign",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "MATCH",
      "tfplan.binary.sigstore.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-sign"
     ],
     [
      "ALLOW",
      "terra/tfplan.binary"
     ],
     [
      "ALLOW",
      "terra/tfplan.binary.sigstore.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "sigstore_verify.txt"
     ]
    ],
    "name": "sigstore-verify",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "terraformplan.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "create-terraformplan-json",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "terraformplan.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "create-terraformplan-json"
     ],
     [
      "ALLOW",
      "tf.rego"
     ],
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "opa_result.txt"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "opa-policy",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   }
  ]
 }
}