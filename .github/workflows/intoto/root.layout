{
 "signatures": [
  {
   "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
   "sig": "8fb154dec9337bc755d82dc8607144badb2f11376d3b541455da72a89f34efc21c3b2f92065f564977edbd6c69ddf6f27e41b638d0b09101448c81956b36382f56a0581c91617a18fbcf742bce46bc2e0524ff7314c61e827387a67e2e80c05a89ef1bab8b0ae5c0a989a811f882ae54aba2608286804097c6e639b59af8c8fa8031ef0040c8bc2a5f6335448168933d3f3ad1d18abb98d347069376ad8b23b60227915b46ed9fb460668c4127ec11587a752df20103fe000c7abade715b23a05b77ceb528d5ba309928a12f02ec27c236000482b7af797a3b9748cc42efb991d1492171869215b461fb070e5406ad5f582dfb6caa3e63e5f3b6397e74f20eb27c601c4a61ce4d716538e67afb3a1d7a21b563e14a31caf30791e11486c65c71e97569877d4bc39994d8bf9368e545d68918065a41c765c83ae8311555a96d55381ba4b69f73f0efc357fd523ee57b1b303adcb4f0fc4855e65c61dc41d068e2bdc550f290d2555cff1a5c3b374262b55ab9660dc48612eebbac3f91755d22cd"
  }
 ],
 "signed": {
  "_type": "layout",
  "expires": "2026-06-24T02:49:07Z",
  "inspect": [
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [],
    "name": "verify-json",
    "run": [
     "terraform",
     "show",
     "-json",
     "tfplan.binary",
     ">",
     "/dev/null"
    ]
   },
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "sigstore_verify.txt",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-verify"
     ]
    ],
    "expected_products": [],
    "name": "sigstore-verify-inspection",
    "run": [
     "cat",
     "sigstore_verify.txt"
    ]
   }
  ],
  "keys": {
   "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1": {
    "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
    "keytype": "rsa",
    "keyval": {
     "public": "-----BEGIN PUBLIC KEY-----\nMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAuOlhGQULSD2cV2rwUuHM\n1CSyP7CfoLJ5OjNJIlfuLL2Mw9dEaxUFAMbVUjW8G02Xv8COI+yRc1/pUYgpeyAJ\n/8iEI9so1bUL82OwxnCspd/75R2udSJSdQLPKn4AHYhy2i8zsGE0GnL35+KtaLRR\nL7mPe5oBdcxpkpuP/G/W8Yt50gmon89/6WIGBdOznGdlnK7i7UNiMR0TwyDVJpcF\nZyNTSAaPhK0rp6yueMSBqKig8zXFhnHsBC8PHBkQ8YaaR1KtUUmu0+Hh5qZUuwTa\nRy36APKdbsfgp91+jvBvkkhCxaN6/QCGraH/ZzJ+cK6QRKjhhsFarNs85TheMDox\nAt5S9LGF2Vik6YkocaB9AHfJgKgxg4GysPuXexFvEDbedQtpjmAxaVfg+AAfC2f2\nsa0c+Mi/1jLIyPHymk9kWlAcmM7ji4R+WAkK5gGVm2l7Kt1EHug4Y08zOOHcmPzW\nuevnLKYGBiLE7NeEyH50lEXAka1EylwA6lyIzZpzfAaPAgMBAAE=\n-----END PUBLIC KEY-----\n"
    },
    "scheme": "rsassa-pss-sha256"
   }
  },
  "readme": "",
  "steps": [
   {
    "_type": "step",
    "expected_command": [
     "bash",
     "-lc",
     "timeout 600 terraform init -input=false -no-color"
    ],
    "expected_materials": [],
    "expected_products": [
     [
      "CREATE",
      ".terraform/*"
     ],
     [
      "CREATE",
      "terraform.lock.hcl"
     ]
    ],
    "name": "terraform-init",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "terraform plan -out=tfplan.binary -input=false"
    ],
    "expected_materials": [
     [
      "MATCH",
      "*",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-init"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "terraform-plan",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [
     "sigstore sign terra/tfplan.binary "
    ],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary.sigstore.json"
     ]
    ],
    "name": "sigstore-sign",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "MATCH",
      "tfplan.binary.sigstore.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-sign"
     ],
     [
      "ALLOW",
      "terra/tfplan.binary"
     ],
     [
      "ALLOW",
      "terra/tfplan.binary.sigstore.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "sigstore_verify.txt"
     ]
    ],
    "name": "sigstore-verify",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "terraformplan.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "create-terraformplan-json",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "terraformplan.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "create-terraformplan-json"
     ],
     [
      "ALLOW",
      "tf.rego"
     ],
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "opa_result.txt"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "opa-policy",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   }
  ]
 }
}