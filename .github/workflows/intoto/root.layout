{
 "signatures": [
  {
   "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
   "sig": "09a61aa2624c233c05ae39787dcb9cc1c3850699900353d941c57f909ea6e916baed7b6099f26e31e3c86e8f5423cde1681bdddb189d35f0fc9f4cb7729b2bfdc5373bef6255745ab8a91a2f991a6d8c9cca619c41f28e2869cead7c7dfb6ccc60fd7c1eda2cb751bdfd43ade5218c0253ef0919d3612f628a7409b9377638f7239c5b437f37d07502b5e0f78650e82fb238ec4a5d07d9a33838e61ffda2f09767c8e5b0739b80847bcd1bb709d7678f9cebf12aa3dde2628ea6bad5779f13fd2d6d2636383ed61ddf019b30b757c138c33887426eab3e0b02bcacfaf27cd4b6dfadaf91e38d76c99a9bd1b05a32b930b85b643a46e2a692a37338bb4af53b09cfd0d593581da70ff4561d116a080eff39a57ff7663189643f97c6cdc01dfb604f4b937199db31464753821ae0cea83ba4cd720d8703fb272a8538e0aaaed34695d2aa81aa85f1a1884665f176a872e47f3f34a3ebce8e65777022270b030405aacd62baf3dbc11fe4cb1a1174b30dd48833da400f42d563b97094e41dd85838"
  }
 ],
 "signed": {
  "_type": "layout",
  "expires": "2026-06-24T00:55:50Z",
  "inspect": [
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ]
    ],
    "expected_products": [],
    "name": "verify-json",
    "run": [
     "terraform",
     "show",
     "-json",
     "tfplan.binary"
    ]
   },
   {
    "_type": "inspection",
    "expected_materials": [],
    "expected_products": [],
    "name": "sigstore-verify-inspection",
    "run": [
     "cat",
     "sigstore_verify.txt"
    ]
   }
  ],
  "keys": {
   "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1": {
    "keyid": "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1",
    "keytype": "rsa",
    "keyval": {
     "public": "-----BEGIN PUBLIC KEY-----\nMIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAuOlhGQULSD2cV2rwUuHM\n1CSyP7CfoLJ5OjNJIlfuLL2Mw9dEaxUFAMbVUjW8G02Xv8COI+yRc1/pUYgpeyAJ\n/8iEI9so1bUL82OwxnCspd/75R2udSJSdQLPKn4AHYhy2i8zsGE0GnL35+KtaLRR\nL7mPe5oBdcxpkpuP/G/W8Yt50gmon89/6WIGBdOznGdlnK7i7UNiMR0TwyDVJpcF\nZyNTSAaPhK0rp6yueMSBqKig8zXFhnHsBC8PHBkQ8YaaR1KtUUmu0+Hh5qZUuwTa\nRy36APKdbsfgp91+jvBvkkhCxaN6/QCGraH/ZzJ+cK6QRKjhhsFarNs85TheMDox\nAt5S9LGF2Vik6YkocaB9AHfJgKgxg4GysPuXexFvEDbedQtpjmAxaVfg+AAfC2f2\nsa0c+Mi/1jLIyPHymk9kWlAcmM7ji4R+WAkK5gGVm2l7Kt1EHug4Y08zOOHcmPzW\nuevnLKYGBiLE7NeEyH50lEXAka1EylwA6lyIzZpzfAaPAgMBAAE=\n-----END PUBLIC KEY-----\n"
    },
    "scheme": "rsassa-pss-sha256"
   }
  },
  "readme": "",
  "steps": [
   {
    "_type": "step",
    "expected_command": [
     "bash",
     "-lc",
     "timeout 600 terraform init -input=false -no-color"
    ],
    "expected_materials": [
     [
      "ALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      ".terraform/*"
     ],
     [
      "CREATE",
      ".terraform.lock.hcl"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "terraform-init",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "*",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-init"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "terraform-plan",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "tfplan.binary.sigstore.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "sigstore-sign",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "MATCH",
      "tfplan.binary.sigstore.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "sigstore-sign"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "sigstore_verify.txt"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "sigstore-verify",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "terraformplan.json"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "create-terraformplan-json",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   },
   {
    "_type": "step",
    "expected_command": [],
    "expected_materials": [
     [
      "MATCH",
      "terraformplan.json",
      "WITH",
      "PRODUCTS",
      "FROM",
      "create-terraformplan-json"
     ],
     [
      "ALLOW",
      "tf.rego"
     ],
     [
      "MATCH",
      "tfplan.binary",
      "WITH",
      "PRODUCTS",
      "FROM",
      "terraform-plan"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "CREATE",
      "opa_result.txt"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "name": "opa-policy",
    "pubkeys": [
     "a2c0b6ba8edb119adfb74f755d5b4a179e4301c5eefbfeace63951d55e5441d1"
    ],
    "threshold": 1
   }
  ]
 }
}